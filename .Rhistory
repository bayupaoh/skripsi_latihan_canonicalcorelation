data <- read.csv("data-skripsi.csv",sep = ";")
getwd();
setwd("~/Desktop/skripsi_latihan_canonicalcorelation/");
library(ggplot2)
library(GGally)
library(CCA)
install.packages("GGally")
install.packages("CCA")
install.packages("CCA")
library(GGally)
library(CCA)
install.packages("CCA")
install.packages("CCA")
data <- read.csv("data-skripsi.csv",sep = ";")
colnames(data)<- c("suhu", "berat", "kelembapan", "amonia", "kematian", "ip","fcr", "hargajual")
summary(data);
kondisiling<- data[,1:5];
kualitasayam <- data[,6:8];
matcor(kondisiling,kualitasayam);
install.packages("CCA")
library(CCA)
matcor(kondisiling,kualitasayam);
ccl <- cc(kondisiling,kualitasayam);
cc$cor
ccl$cor
ccl[3:4]
ccl[4:5]
ccl[3:4]
cc2 <- comput(kondisiling, kualitasayam, cc1)
cc2 <- comput(kondisiling, kualitasayam, ccl)
cc2[3:6]
ev <- (1 - cc1$cor^2)
n <- dim(kondisiling)[1]
p <- length(kondisiling)
q <- length(kualitasayam)
k <- min(p, q)
m <- n - 3/2 - (p + q)/2
w <- rev(cumprod(rev(ev)))
# initialize
d1 <- d2 <- f <- vector("numeric", k)
for (i in 1:k) {
s <- sqrt((p^2 * q^2 - 4)/(p^2 + q^2 - 5))
si <- 1/s
d1[i] <- p * q
d2[i] <- m * s - p * q/2 + 1
r <- (1 - w[i]^si)/w[i]^si
f[i] <- r * d2[i]/d1[i]
p <- p - 1
q <- q - 1
}
pv <- pf(f, d1, d2, lower.tail = FALSE)
(dmat <- cbind(WilksL = w, F = f, df1 = d1, df2 = d2, p = pv))
ev <- (1 - cc1$cor^2)
ev <- (1 - ccl$cor^2)
n <- dim(kondisiling)[1]
p <- length(kondisiling)
q <- length(kualitasayam)
k <- min(p, q)
m <- n - 3/2 - (p + q)/2
w <- rev(cumprod(rev(ev)))
d1 <- d2 <- f <- vector("numeric", k)
for (i in 1:k) {
s <- sqrt((p^2 * q^2 - 4)/(p^2 + q^2 - 5))
si <- 1/s
d1[i] <- p * q
d2[i] <- m * s - p * q/2 + 1
r <- (1 - w[i]^si)/w[i]^si
f[i] <- r * d2[i]/d1[i]
p <- p - 1
q <- q - 1
}
pv <- pf(f, d1, d2, lower.tail = FALSE)
(dmat <- cbind(WilksL = w, F = f, df1 = d1, df2 = d2, p = pv))
s1 <- diag(sqrt(diag(cor(kondisiling))))
s1 %*% ccl$xcoef
s2 <- diag(sqrt(diag(cor(kualitasayam))))
s2 %*% ccl$ycoef
update.packages()
matcor(kondisiling,kualitasayam);
matcor(kondisiling,kualitasayam)
matcor<-matcor(kondisiling,kualitasayam)
matcor$Xcor
matcor$Xcor%*%matcor$Xcor
hasil<-matcor$Xcor%*%matcor$Xcor
matcor$Xcor%*%matcor$Xcor
drop(hasil)
View(hasil)
drop(hasil)
solve(matcor$Ycor)
matcor$XYcor[1-5,5,7]
matcor$XYcor[1-5,5-7]
matcor$XYcor[1:5,5:7]
eigen(solve(matcor$Ycor)%*%matcoryx%*%solve(matcor$Xcor)%*%matcoryx)
matcoryx <- matcor$XYcor[6-8,1:5]
eigen(solve(matcor$Ycor)%*%matcoryx%*%solve(matcor$Xcor)%*%matcoryx)
solve(matcor$Ycor)%*%matcoryx%*%solve(matcor$Xcor)%*%matcoryx
solve(matcor$Ycor)%*%matcoryx%*%solve(matcor$Xcor)%*%matcorxy
matcorxy <- matcor$XYcor[1:5,6-8]
solve(matcor$Ycor)%*%matcoryx%*%solve(matcor$Xcor)%*%matcorxy
eigen()
solve(matcor$Ycor)%*%matcoryx
solve(matcor$Ycor)
solve(matcor$Ycor)
matcoryx <- matcor$XYcor[6-8,1:5]
matcoryx
matcoryx <- matcor$XYcor[6:8,1:5]
matcorxy <- matcor$XYcor[1:5,6:8]
matcoryx <- matcor$XYcor[6:8,1:5]
solve(matcor$Ycor)%*%matcoryx%*%solve(matcor$Xcor)%*%matcorxy
eigen(solve(matcor$Ycor)%*%matcoryx%*%solve(matcor$Xcor)%*%matcorxy)
matcorxy <- matcor$XYcor[1:5,6:8]
matcorxy
bi <- eigen(solve(matcor$Ycor)%*%matcoryx%*%solve(matcor$Xcor)%*%matcorxy)
bi
solve(matcor$Xcor)%*%matcorxy%*%bi$vectors
ai<-solve(matcor$Xcor)%*%matcorxy%*%bi$vectors
ai
-14.5*-2.344
lamda <- bi$values
lamda
lamda[1,1]
lamda[2]
lamda[3]
corxui<-matcor$Xcor%*%ai[,1]
corxui
coryvi<-matcor$Ycor%*%bi[,1]
coryvi<-matcor$Ycor%*%bi$values[,1]
bi$values
coryvi<-matcor$Ycor%*%bi$vectors[,1]
coryvi
which.max(lamda)
max<-which.max(lamda)
corxui<-matcor$Xcor%*%ai[,max]
corxui
n-0.5*(p+q+1)
n
View(data)
View(data)
-1*(n-0.5*(p+q+1))
lamda
length(lamda)
sum(lamda)
sum(lamda*2)
sum(log(1-lamda))
-1*(n-0.5*(p+q+1))*(sum(log(1-lamda)))
hasil <- (-1*(n-0.5*(p+q+1)))*(sum(log(1-lamda)))
hasil
